<#
    Title: exo colors
    Version: 0.1.0
    Author: James Velasquez. aka Xyberviri, Emareks
    Description: this script generates a csv file of all exo planets
    
    This work is licensed under the GNU GENERAL PUBLIC LICENSE Version 3
    To view a copy of this license, visit https://www.gnu.org/licenses/gpl-3.0.en.html
#>
param (
    [string]$settings_file = "$PSScriptRoot/settings.json",
    [switch]$dryrun = $false,
    [switch]$test = $false,
    [switch]$update = $false,
    [switch]$verbose = $false
     )


$colors = @'
{
  "1": "Black",
  "2": "Night Azure",
  "3": "Shadow Cerulean",
  "4": "Dark Cerulean",
  "5": "Dark Cobalt",
  "6": "Dark Berry",
  "7": "Dark Violet",
  "8": "Dark Lilac",
  "9": "Strong Violet",
  "10": "Strong Magenta",
  "11": "Strong Fuchsia",
  "12": "Strong Cherry",
  "13": "Dark Red",
  "14": "Dark Orange",
  "15": "Dark Rose",
  "16": "Dark Fuchsia",
  "17": "Shadow Fuchsia",
  "18": "Night Berry",
  "19": "Night Fuchsia",
  "20": "Night Orange",
  "21": "Shadow Orange",
  "22": "Shadow Red",
  "23": "Strong Red",
  "24": "Deep Red",
  "25": "Hot Cherry",
  "26": "Silk Cherry",
  "27": "Oxide Rose",
  "28": "Silk Orange",
  "29": "Silk Mustard",
  "30": "Hot Sepia",
  "31": "Deep Mustard",
  "32": "Hot Tan",
  "33": "Silk Yellow",
  "34": "Deep Yellow",
  "35": "Hot Moss",
  "36": "Deep Green",
  "37": "Strong Green",
  "38": "Dark Green",
  "39": "Dark Yellow",
  "40": "Strong Yellow",
  "41": "Strong Mustard",
  "42": "Dark Mustard",
  "43": "Shadow Mustard",
  "44": "Shadow Yellow",
  "45": "Night Green",
  "46": "Shadow Turquoise",
  "47": "Dark Turquoise",
  "48": "Dark Grey",
  "49": "Oxide Azure",
  "50": "Oxide Grey",
  "51": "Oxide Yellow",
  "52": "Oxide Green",
  "53": "Silk Mint",
  "54": "Silk Teal",
  "55": "Deep Turquoise",
  "56": "Deep Slate",
  "57": "Deep Azure",
  "58": "Deep Cerulean",
  "59": "Silk Cobalt",
  "60": "Silk Cerulean",
  "61": "Oxide Blue",
  "62": "Oxide Violet",
  "63": "Silk Berry",
  "64": "Silk Lilac",
  "65": "Silk Lavender",
  "66": "Deep Lavender",
  "67": "Deep Lilac",
  "68": "Deep Violet",
  "69": "Hot Magenta",
  "70": "Silk Magenta",
  "71": "Deep Fuchsia",
  "72": "Warm Fuchsia",
  "73": "Warm Magenta",
  "74": "Fuchsia",
  "75": "Rose",
  "76": "Warm Cherry",
  "77": "Cherry",
  "78": "Red",
  "79": "Warm Red",
  "80": "Stale Red",
  "81": "Warm Orange",
  "82": "Stale Sepia",
  "83": "Warm Mustard",
  "84": "Stale Tan",
  "85": "Warm Yellow",
  "86": "Stale Moss",
  "87": "Warm Viridian",
  "88": "Teal",
  "89": "Viridian",
  "90": "Mint",
  "91": "Green",
  "92": "Warm Moss",
  "93": "Yellow",
  "94": "Tan",
  "95": "Mustard",
  "96": "Sepia",
  "97": "Orange",
  "98": "Vivid Orange",
  "99": "Light Sepia",
  "100": "Light Orange",
  "101": "Pale Sepia",
  "102": "Ashen Taupe",
  "103": "Ashen Yellow",
  "104": "Pale Tan",
  "105": "Light Mustard",
  "106": "Light Tan",
  "107": "Light Yellow",
  "108": "Pale Moss",
  "109": "Ashen Mint",
  "110": "Ashen Turquoise",
  "111": "Ashen Grey",
  "112": "Rust Slate",
  "113": "Stale Turquoise",
  "114": "Rust Lime",
  "115": "Rust Taupe",
  "116": "Rust Fuchsia",
  "117": "Rust Violet",
  "118": "Stale Berry",
  "119": "Warm Violet",
  "120": "Stale Lilac",
  "121": "Warm Blue",
  "122": "Blue",
  "123": "Lavender",
  "124": "Lilac",
  "125": "Violet",
  "126": "Vivid Violet",
  "127": "Vivid Lilac",
  "128": "Vivid Lavender",
  "129": "Vivid Blue",
  "130": "Light Blue",
  "131": "Pale Lilac",
  "132": "Light Lilac",
  "133": "Pale Berry",
  "134": "Ashen Berry",
  "135": "Ashen Red",
  "136": "Cool Red",
  "137": "Stark Orange",
  "138": "Bright Orange",
  "139": "Bright Sepia",
  "140": "Bright Taupe",
  "141": "Bright Mustard",
  "142": "Bright Tan",
  "143": "Bright Yellow",
  "144": "Bright Lime",
  "145": "Bright Moss",
  "146": "Bright Green",
  "147": "Stark Green",
  "148": "Bright Viridian",
  "149": "Stark Viridian",
  "150": "Cool Mint",
  "151": "Cool Teal",
  "152": "Stark Turquoise",
  "153": "Bright Turquoise",
  "154": "Bright Slate",
  "155": "Bright Azure",
  "156": "Stark Azure",
  "157": "Bright Cerulean",
  "158": "Bright Blue",
  "159": "Stark Lavender",
  "160": "Cool Blue",
  "161": "Weary Violet",
  "162": "Cool Violet",
  "163": "Bright Lilac",
  "164": "Bright Magenta",
  "165": "Bright Violet",
  "166": "Light Berry",
  "167": "Vivid Fuchsia",
  "168": "Light Fuchsia",
  "169": "Light Red",
  "170": "Vivid Cherry",
  "171": "Vivid Red",
  "172": "Bright Red",
  "173": "Bright Fuchsia",
  "174": "Luminous Violet",
  "175": "Cold Berry",
  "176": "Luminous Blue",
  "177": "Luminous Azure",
  "178": "Cold Slate",
  "179": "Luminous Slate",
  "180": "Cool Slate",
  "181": "Weary Teal",
  "182": "Cool Grey",
  "183": "Weary Mustard",
  "184": "Cool Taupe",
  "185": "Stark Mustard",
  "186": "Cool Tan",
  "187": "Weary Yellow",
  "188": "Cool Lime",
  "189": "Stark Lime",
  "190": "Stark Yellow",
  "191": "Crisp Yellow",
  "192": "Crisp Lime",
  "193": "Luminous Moss",
  "194": "Luminous Green",
  "195": "Crisp Green",
  "196": "Cold Lime",
  "197": "Cold Viridian",
  "198": "Cold Teal",
  "199": "Crisp Teal",
  "200": "Luminous Viridian",
  "201": "Luminous Turquoise",
  "202": "Vivid Turquoise",
  "203": "Light Turquoise",
  "204": "Vivid Slate",
  "205": "Vivid Azure",
  "206": "Light Azure",
  "207": "Pale Cerulean",
  "208": "Vivid Cobalt",
  "209": "Vivid Cerulean",
  "210": "Cerulean",
  "211": "Azure",
  "212": "Slate",
  "213": "Turquoise",
  "214": "Vivid Teal",
  "215": "Light Viridian",
  "216": "Vivid Viridian",
  "217": "Vivid Mint",
  "218": "Vivid Green",
  "219": "Vivid Moss",
  "220": "Vivid Lime",
  "221": "Vivid Yellow",
  "222": "Vivid Mustard",
  "223": "Luminous Tan",
  "224": "Crisp Tan",
  "225": "Cold Tan",
  "226": "Luminous Taupe",
  "227": "Luminous Red",
  "228": "White",
  "229": "Cool Azure",
  "230": "Ashen Blue",
  "231": "Rust Blue",
  "232": "Stale Cerulean",
  "233": "Cobalt",
  "234": "Deep Cobalt",
  "235": "Deep Blue",
  "236": "Strong Blue",
  "237": "Strong Cobalt",
  "238": "Strong Cerulean",
  "239": "Strong Azure",
  "240": "Strong Slate",
  "241": "Strong Turquoise",
  "242": "Strong Viridian",
  "243": "Shadow Green",
  "244": "Deep Viridian",
  "245": "Silk Turquoise",
  "246": "Dark Blue",
  "247": "Night Blue",
  "248": "Shadow Blue",
  "249": "Strong Lavender",
  "250": "Shadow Violet",
  "251": "Night Lilac",
  "252": "Strong Orange",
  "253": "Deep Orange",
  "254": "Hot Orange",
  "255": "Luminous Yellow"
}
'@

$blocks = @'
{
    "13":  "Verdant Grass",
    "3085":  "Barbed Grass",
    "6157":  "Gnarled Grass",
    "10794":  "Metamorphic Rock",
    "10802":  "Sedimentary Rock",
    "10798":  "Igneous Rock",
    "10838":  "Lustrous Trunk",
    "10830":  "Ancient Trunk",
    "10834":  "Twisted Trunk",
    "10870":  "Growth",
    "10866":  "Mould",
    "9555":  "Gleam",
    "9838":  "Gladeflower",
    "9839":  "Cloneflower",
    "9840":  "Spineflower",
    "9841":  "Ghostflower",
    "10774":  "Traveller's Perch",
    "10775":  "Trumpet Root",
    "10776":  "Rosetta Nox",
    "10777":  "Desert Sword",
    "10778":  "Spineback Plant",
    "10779":  "Twisted Aloba",
    "10780":  "Stardrop Plant",
    "10781":  "Oortian's Staff",
    "10788":  "Mottled Tar Spot Fungus",
    "10789":  "Clustered Tongue Fungus",
    "10790":  "Branch Funnel Fungus",
    "10791":  "Tinted-burst Fungus",
    "10792":  "Weeping Waxcap Fungus",
    "10793":  "Glow Cap Fungus",
    "10806":  "Glacier",
    "10810":  "Sand",
    "10814":  "Gravel",
    "10826":  "Waxy Foliage",
    "10818":  "Lush Foliage",
    "10822":  "Exotic Foliage",
    "10842":  "Ice",
    "10846":  "Mud",
    "11584":  "Silty Soil",
    "11588":  "Clay Soil",
    "11592":  "Peaty Soil",
    "10850":  "Ash",
    "10854":  "Sponge",
    "10858":  "Tangle",
    "10862":  "Thorns",
    "32778":  "Hard Coal",
    "32777":  "Medium Coal",
    "32779":  "Soft Coal",
    "32800":  "Rough Amethyst",
    "32804":  "Rough Emerald",
    "32803":  "Rough Diamond",
    "32807":  "Rough Ruby",
    "32809":  "Rough Topaz",
    "32808":  "Rough Sapphire",
    "33081":  "Small Fossil",
    "33082":  "Medium Fossil",
    "33083":  "Large Fossil",
    "32785":  "Copper Ore",
    "32787":  "Iron Ore",
    "32788":  "Silver Ore",
    "32786":  "Gold Ore",
    "32789":  "Titanium Ore",
    "33078":  "Ancient Tech Component",
    "33080":  "Ancient Tech Remnant",
    "33079":  "Ancient Tech Device",
    "10782":  "Basic Boulder",
    "11635":  "Tuber Plant",
    "10784":  "Boulder Tower",
    "11641":  "Kranut Plant",
    "10787":  "Tapered Boulder",
    "11645":  "Combustion Fraction",
    "11642":  "Starberry Vine",
    "11632":  "Oortian Rice",
    "11633":  "Oorum Wheat",
    "11634":  "Ancient Oat",
    "11643":  "Glossy Starberry Vine",
    "10783":  "Beanstalk Boulder",
    "11637":  "Exotic Tuber Plant",
    "13620":  "Amethyst Seam",
    "13624":  "Diamond Seam",
    "13628":  "Emerald Seam",
    "13632":  "Topaz Seam",
    "13636":  "Ruby Seam",
    "13640":  "Sapphire Seam",
    "13644":  "Rift Seam",
    "13648":  "Blink Seam",
    "13652":  "Copper Seam",
    "13656":  "Iron Seam",
    "13660":  "Silver Seam",
    "13664":  "Gold Seam",
    "13668":  "Titanium Seam",
    "13672":  "Soft Coal Seam",
    "13676":  "Coal Seam",
    "13680":  "Hard Coal Seam",
    "13684":  "Small Fossil Seam",
    "13688":  "Medium Fossil Seam",
    "13692":  "Large Fossil Seam",
    "13696":  "Ancient Tech Remnant Seam",
    "13700":  "Ancient Tech Component Seam",
    "13704":  "Ancient Tech Device Seam",
    "9333":  "Guild Control",
    "9471":  "Refined Metamorphic Rock",
    "9475":  "Refined Igneous Rock",
    "9479":  "Refined Sedimentary Rock",
    "9539":  "Twisted Wood Timber",
    "9543":  "Ancient Wood Timber",
    "9547":  "Lustrous Wood Timber",
    "9623":  "Refined Copper",
    "9627":  "Refined Iron",
    "9631":  "Refined Silver Alloy",
    "9635":  "Refined Gold Alloy",
    "9639":  "Refined Titanium Alloy",
    "9603":  "Compact Copper",
    "9607":  "Compact Iron",
    "9611":  "Compact Silver Alloy",
    "9615":  "Compact Gold Alloy",
    "9619":  "Compact Titanium Alloy",
    "9768":  "Dark Glass",
    "9426":  "mantle",
    "9427":  "Compact Silt",
    "9431":  "Compact Clay",
    "9435":  "Compact Peat",
    "9439":  "Metamorphic Stones",
    "9443":  "Igneous Stones",
    "9447":  "Sedimentary Stones",
    "9451":  "Sedimentary Brick",
    "9455":  "Metamorphic Brick",
    "9459":  "Igneous Brick",
    "9483":  "Decorative Metamorphic Rock 1",
    "9487":  "Decorative Igneous Rock 1",
    "9491":  "Decorative Sedimentary Rock 1",
    "9495":  "Decorative Metamorphic Rock 2",
    "9499":  "Decorative Igneous Rock 2",
    "9503":  "Decorative Sedimentary Rock 2",
    "10874":  "Ancient Corruption",
    "9591":  "Compact Soft Coal",
    "9595":  "Compact Coal",
    "9599":  "Compact Hard Coal",
    "9643":  "Machined Copper",
    "9647":  "Machined Iron",
    "9651":  "Machined Silver Alloy",
    "9655":  "Machined Gold Alloy",
    "9659":  "Machined Titanium Alloy",
    "9663":  "Compact Amethyst",
    "9667":  "Compact Diamond",
    "9671":  "Compact Emerald",
    "9675":  "Compact Topaz",
    "9679":  "Compact Ruby",
    "9683":  "Compact Sapphire",
    "9687":  "Decorative Amethyst",
    "9691":  "Decorative Diamond",
    "9695":  "Decorative Emerald",
    "9699":  "Decorative Topaz",
    "9703":  "Decorative Ruby",
    "9707":  "Decorative Sapphire",
    "13708":  "Umbris Seam",
    "13712":  "Oortstone Seam",
    "9719":  "Helix Power Coil",
    "9720":  "Chrysominter",
    "9721":  "Chrysominter Power Coil",
    "9722":  "Letter Box",
    "9723":  "Plain Stone Beam",
    "9724":  "Plain Wood Beam",
    "9725":  "Compact Rift",
    "9729":  "Compact Blink",
    "9733":  "Compact Umbris",
    "9737":  "Compact Oortstone",
    "9741":  "Decorative Rift",
    "9745":  "Decorative Blink",
    "9749":  "Decorative Umbris",
    "9753":  "Decorative Oortstone",
    "9757":  "Plain Stone Pole",
    "9761":  "Plain Metal Beam",
    "9762":  "Plain Gleam Beam",
    "9763":  "Stylish Stone Beam",
    "9764":  "Glass",
    "9772":  "Lantern",
    "9776":  "Gleam Lantern",
    "9780":  "Portal Conduit",
    "9781":  "Trampoline",
    "9785":  "Slide",
    "9789":  "Workbench",
    "9790":  "Stone Furnace Base",
    "9791":  "Iron Furnace Base",
    "9792":  "Titanium Furnace Base",
    "9793":  "Stone Furnace Crucible",
    "9794":  "Iron Furnace Crucible",
    "9795":  "Titanium Furnace Crucible",
    "9796":  "Centraforge Power Coil",
    "9797":  "Advanced Centraforge Power Coil",
    "9798":  "Compactor Power Coil",
    "9799":  "Advanced Compactor Power Coil",
    "9800":  "Refinery Power Coil",
    "9801":  "Advanced Refinery Power Coil",
    "9802":  "Extractor Power Coil",
    "9803":  "Advanced Extractor Power Coil",
    "9804":  "Mixer Power Coil",
    "9805":  "Advanced Mixer Power Coil",
    "9806":  "Workbench Power Coil",
    "9807":  "Advanced Workbench Power Coil",
    "9808":  "Extractor",
    "9809":  "Compactor",
    "9810":  "Mixer",
    "9811":  "Refinery",
    "9812":  "Centraforge",
    "9813":  "Spark Generator",
    "9814":  "Spark Link",
    "9815":  "Plain Wood Door",
    "9816":  "World Control",
    "9817":  "Plain Wood Trapdoor",
    "9818":  "Storage Block",
    "9820":  "Basic Torch",
    "9822":  "Plinth",
    "9823":  "Table",
    "9824":  "Chair",
    "9827":  "Door Lock",
    "9828":  "Advanced Lock",
    "9829":  "Request Basket",
    "9830":  "Shop Stand",
    "9831":  "Beacon Control",
    "9843":  "Storage Shelf",
    "9856":  "Crafting Table",
    "9857":  "Torch",
    "9858":  "Amethyst Torch",
    "9859":  "Diamond Torch",
    "9860":  "Emerald Torch",
    "9861":  "Topaz Torch",
    "9862":  "Ruby Torch",
    "9863":  "Sapphire Torch",
    "9864":  "Refined Gleam",
    "9872":  "Warp Conduit",
    "9873":  "warp conduit loading",
    "9874":  "warp conduit smashing",
    "9875":  "warp conduit open",
    "9876":  "warp conduit dormant",
    "9877":  "portal conduit loading",
    "9878":  "portal conduit smashing",
    "9879":  "portal conduit open",
    "9880":  "portal conduit dormant",
    "9881":  "portal conduit entity",
    "9882":  "Campfire",
    "10785":  "Boulder Ring",
    "10786":  "Boulder Chip",
    "9901":  "Refined Ancient Wood",
    "9905":  "Refined Twisted Wood",
    "9909":  "Refined Lustrous Wood",
    "9913":  "Decorative Ancient Wood",
    "9917":  "Decorative Twisted Wood",
    "9921":  "Decorative Lustrous Wood",
    "10077":  "Refined Rift",
    "10081":  "Refined Blink",
    "10345":  "Refined Umbris",
    "10349":  "Refined Oortstone",
    "10353":  "Plain Wood Pole",
    "10357":  "Plain Metal Pole",
    "10361":  "Plain Gleam Pole",
    "10365":  "Stylish Stone Pole",
    "10369":  "Stylish Wood Pole",
    "10373":  "Stylish Metal Pole",
    "10625":  "Stone Sign Module",
    "10626":  "sign stone modularcomplete",
    "10627":  "Stone Sign",
    "10628":  "Wood Sign Module",
    "10629":  "sign wood modularcomplete",
    "10630":  "Wood Sign",
    "10631":  "Metal Sign Module",
    "10632":  "sign metal modularcomplete",
    "10633":  "Metal Sign",
    "10634":  "Gleam Sign Module",
    "10635":  "sign gleam modularcomplete",
    "10636":  "Gleam Sign",
    "10637":  "meteorite active",
    "10649":  "meteorite inactive",
    "10661":  "Stylish Gleam Pole",
    "10665":  "Ornate Stone Pole",
    "10669":  "Ornate Wood Pole",
    "10673":  "Ornate Metal Pole",
    "10677":  "Stylish Wood Beam",
    "10678":  "Stylish Metal Beam",
    "10695":  "Glass Sign Module",
    "10696":  "sign glass modularcomplete",
    "10697":  "Glass Sign",
    "10698":  "Glowing Glass Sign Module",
    "10699":  "sign glass refinedmodularcomplete",
    "10700":  "Glowing Glass Sign",
    "10701":  "Crafty Cauldron",
    "10702":  "Bat",
    "10703":  "Bat Crop",
    "10752":  "Plain Stone Door",
    "10753":  "Plain Metal Door",
    "10754":  "Plain Gleam Door",
    "10755":  "Stylish Wood Door",
    "10756":  "Stylish Stone Door",
    "10757":  "Stylish Metal Door",
    "10758":  "Stylish Gleam Door",
    "10759":  "Ornate Wood Door",
    "10760":  "Ornate Stone Door",
    "10761":  "Ornate Metal Door",
    "10762":  "Ornate Gleam Door",
    "10763":  "Plain Stone Trapdoor",
    "10764":  "Plain Metal Trapdoor",
    "10765":  "Plain Gleam Trapdoor",
    "10766":  "Stylish Wood Trapdoor",
    "10767":  "Stylish Stone Trapdoor",
    "10768":  "Stylish Metal Trapdoor",
    "10769":  "Stylish Gleam Trapdoor",
    "10770":  "Ornate Wood Trapdoor",
    "10771":  "Ornate Stone Trapdoor",
    "10772":  "Ornate Metal Trapdoor",
    "10773":  "Ornate Gleam Trapdoor",
    "11046":  "Spooky Skull Lantern",
    "11047":  "Spooky Pumpkin Lantern",
    "11048":  "Defeat Insurance Helix",
    "11049":  "Home Healing Helix",
    "11050":  "Building Safety Helix",
    "11051":  "Builder\u0027s Buff Helix",
    "11052":  "Brew Extension Helix",
    "11053":  "Weapon Augment Durability Helix",
    "11054":  "Bonus Consumables Helix",
    "11055":  "Spark and Wear Helix",
    "11056":  "Grapple and Run Helix",
    "11058":  "Gatherer Healing Helix",
    "11059":  "Lava Protection Helix",
    "11060":  "Hammer Versatility Helix",
    "11062":  "Snowcitizen Happy Head",
    "11063":  "Snowcitizen Glum Head",
    "11064":  "Snowcitizen Cute Head",
    "11065":  "Snowcitizen Body",
    "11066":  "Red Gift Box",
    "11067":  "Pink Gift Box",
    "11068":  "Teal Gift Box",
    "11069":  "Gold Gift Box",
    "11070":  "Silver Gift Box",
    "11071":  "Oortmas Tree Top",
    "11072":  "Oortmas Tree Bottom",
    "11073":  "LED Block",
    "11077":  "special blink led1",
    "11081":  "special blink led2",
    "11085":  "special blink led3",
    "11089":  "special blink led4",
    "11093":  "special blink led5",
    "11097":  "special blink led6",
    "11101":  "special blink led7",
    "11105":  "special blink led8",
    "11109":  "special blink led9",
    "11113":  "special blink led10",
    "11117":  "special blink led11",
    "11121":  "special blink led12",
    "11125":  "special blink led13",
    "11129":  "special blink led14",
    "11133":  "special blink led15",
    "11265":  "Marble",
    "11277":  "Decorative Refined Gravel",
    "11289":  "Decorative Wicker",
    "11301":  "Mosaic",
    "11341":  "Romantic Vase",
    "11342":  "Heart Balloons",
    "11343":  "Romantic Stone Column",
    "11347":  "Ornate Gleam Pole",
    "11351":  "Stylish Gleam Beam",
    "11352":  "Ornate Stone Beam",
    "11353":  "Ornate Wood Beam",
    "11354":  "Ornate Metal Beam",
    "11355":  "Ornate Gleam Beam",
    "11620":  "soil clay tilled",
    "11624":  "soil peaty tilled",
    "11628":  "soil silty tilled",
    "11636":  "Waxy Tuber Plant",
    "11638":  "Ornamental Oortweed",
    "11639":  "Imperial Harlequin",
    "11640":  "Ancestor\u0027s Blade",
    "11644":  "Juicy Starberry Vine",
    "11646":  "Kindling Mass",
    "11647":  "Goo",
    "11648":  "Compact Combustion Particle",
    "11652":  "Coal-infused Combustion Particle",
    "11656":  "Enriched Combustion Particle",
    "11660":  "Enriched Soft Coal",
    "11664":  "Enriched Coal",
    "11668":  "Enriched Hard Coal",
    "11672":  "Enriched Peat",
    "11732":  "Spray Tinter",
    "11733":  "Pigment Processor",
    "11734":  "Pigment Processor Power Coil",
    "11735":  "Amber",
    "11739":  "Bitumen",
    "11759":  "Trailing Starblossom",
    "11760":  "Sentinel\u0027s Crest",
    "11761":  "Plain Glass Pane",
    "11762":  "Stylish Glass Pane",
    "11763":  "Ornate Glass Pane",
    "12988":  "Copper Circuit Board",
    "12992":  "Iron Circuit Board",
    "12996":  "Silver Circuit Board",
    "13000":  "Gold Circuit Board",
    "13004":  "Titanium Circuit Board",
    "13088":  "Copper Filigree",
    "13092":  "Iron Filigree",
    "13096":  "Silver Filigree",
    "13100":  "Gold Filigree",
    "13104":  "Titanium Filigree",
    "13188":  "Copper Octigrid",
    "13192":  "Iron Octigrid",
    "13196":  "Silver Octigrid",
    "13200":  "Gold Octigrid",
    "13204":  "Titanium Octigrid",
    "13288":  "Decorative Gleam",
    "13308":  "Decorative Ice",
    "13328":  "Marble Border",
    "13332":  "Oortian Marble - Miner",
    "13368":  "Linear Mosaic",
    "13372":  "Fish Scale Mosaic",
    "13408":  "Concrete",
    "13412":  "Patterned Concrete",
    "13448":  "Plain Wooden Trellis",
    "13468":  "Lush Foliage Trellis",
    "13488":  "Exotic Foliage Trellis",
    "13508":  "Waxy Foliage Trellis",
    "13528":  "Mould-Covered Trellis",
    "13548":  "Plain Wood Chest",
    "13549":  "Stylish Wood Barrel",
    "13550":  "Ornate Wood Box",
    "13551":  "Plain Stone Trunk",
    "13552":  "Stylish Stone Cabinet",
    "13553":  "Ornate Stone Box",
    "13554":  "Plain Metal Crate",
    "13555":  "Stylish Metal Cabinet",
    "13556":  "Ornate Metal Chest",
    "13557":  "Plain Gleam Cabinet",
    "13558":  "Stylish Gleam Vase",
    "13559":  "Ornate Gleam Chest",

    "33561": "Petrolim",
    "33562": "Primordial Resin"
}
'@



    $block_names = $blocks |ConvertFrom-Json
    $color_names = $colors |ConvertFrom-Json


Function Update-Planet($dataurl)
{


    #Get data for this specific planet
    $content = Invoke-RestMethod -Uri $dataurl
    

    

    $block_colors = Invoke-RestMethod -Uri $content.block_colors_url



   ("{0},{1}{2}" -f $content.text_name, $content.id, (Build-ColorPalette -block_Colors  $block_colors)) | Out-File -FilePath $PSScriptRoot/exo-color-sheet.csv -Append

}


Function Build-ColorPalette()
{    
    param ($block_Colors)

    $return_value=""
        
        foreach($color in $block_Colors.block_colors ) 
        {
        ##
            
           

           # $img_name = $block_names.($color.item.game_id)
           $color_name =  $color_names.($color.color.game_id)

           $return_value += ( ",$color_name("+$color.color.game_id+")" )           

        ##
        }
        $return_value
}


$prodexouri="https://api.boundlexx.app/api/v1/worlds/simple?format=json&is_exo=true&limit=999&offset=0&show_inactive=true"

$response = ""
try {
    $response = Invoke-RestMethod -Uri $prodexouri     
}
catch {
    Write-Host "An error occurred while attemping to fetch exo data from $prodexouri"
    Write-Host $_
    Write-Host "Nothing to check because i'm receiving no data, exiting."
    exit
}



("Planet,id,Verdant Grass,Barbed Grass,Gnarled Grass,Gleam,Gladeflower,Cloneflower,Spineflower,Ghostflower,Traveller's Perch,Trumpet Root,Rosetta Nox,Desert Sword,Spineback Plant,Twisted Aloba,Stardrop Plant,Oortian's Staff,Mottled Tar Spot Fungus,Clustered Tongue Fungus,Branch Funnel Fungus,Tinted-burst Fungus,Weeping Waxcap Fungus,Glow Cap Fungus,Metamorphic Rock,Igneous Rock,Sedimentary Rock,Glacier,Sand,Gravel,Lush Foliage,Exotic Foliage,Waxy Foliage,Ancient Trunk,Twisted Trunk,Lustrous Trunk,Ice,Mud,Ash,Sponge,Tangle,Thorns,Mould,Growth,Silty Soil,Clay Soil,Peaty Soil")| Out-File -FilePath $PSScriptRoot/exo-color-sheet.csv -Append

$total = 0

foreach($result in $response.results){
$total += 1

    Write-Host ("({0}{1}) {2}" -f, $total, $response.results.Count, $result.text_name)
    Update-Planet($result.url)
    
}

